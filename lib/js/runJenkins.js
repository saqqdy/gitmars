"use strict";const e=require("shelljs"),t=require("./apollo"),{error:i,success:n,mapTemplate:r}=require("./index");module.exports=async function({env:o,project:s,app:p="all"}){const a=await t(),c=a[o];let l;if(!c)return e.echo(i("请输入正确的环境名称")),void e.exit(1);if(l=c.list.find((e=>e.name===s)),!l)return e.echo(i("请输入正确的项目名称")),void e.exit(1);if(p&&l.apps&&!l.apps.includes(p))return e.echo(i("请输入正确的应用名称")),void e.exit(1);if(!a.template)return e.echo(i("请配置Jenkins构建地址模板")),void e.exit(1);const u=r(l.apps&&l.apps.length>0?a.templateWithParam:a.template,{line:c.line,project:l.project,token:c.token,app:p});e.exec(`curl -u ${a.username}:${a.password} "${u}"`,{silent:!0}),e.echo(n("成功调起Jenkins构建"))};
