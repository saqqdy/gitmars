"use strict";const{spawnSync:s}=require("child_process"),e=require("../checkGitDirEnv"),o=require("../getConfig")();function n([,,e="",...n],{cwd:t=process.cwd()}={}){const c=function(s,e){return o&&o.hooks&&o.hooks[e]}(0,e),i={};return(null==n?void 0:n.length)&&(i.GITMARS_GIT_PARAMS=n.join(" ")),c?function(e,o,n,t){console.info(`gitmars > ${o} (node ${process.version})`);const{status:c}=s("sh",["-c",n],{cwd:e,env:Object.assign(Object.assign({},process.env),t),stdio:"inherit"});if(0!==c){const s=["commit-msg","pre-commit","pre-rebase","pre-push"].includes(o)?"(add --no-verify to bypass)":"(cannot be bypassed with --no-verify due to Git specs)";console.info(`gitmars > ${o} hook failed ${s}`)}return 127===c?1:c||0}(t,e,c,i):0}module.exports=async function(){e();try{const s=await n(process.argv);process.exit(s)}catch(s){console.info("Gitmars > 未知错误！请联系吴峰",s),process.exit(1)}};
