#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),i=require("shelljs"),t=require("./js/gitRevParse"),{error:s,success:o,writeFile:r,isGitProject:c}=require("./js/index"),{defaults:a}=require("./js/global");c()||(i.echo(s("当前目录不是git项目目录")),i.exit(1));const n=require("./js/getConfig")();e.name("gitm config").usage("<option> [value]").command("set <option> [value]").description("设置gitmars的配置项").action((async(e,c)=>{let{filepath:l}=n;if(!l){const{root:e}=t();l=e+"/.gitmarsrc"}c?Object.keys(a).includes(e)?(n[e]=c,delete n.filepath,delete n.skipCI,await r(l,JSON.stringify(n,null,4)),i.echo(o("保存成功")),i.exit(0)):(i.echo(s("不支持"+e+"这个配置项")),i.exit(1)):(i.echo("请输入要配置的项"),i.exit(1))})),e.name("gitm config").usage("list [option]").command("list [option]").description("查询单个或全部gitmars的配置项").action((e=>{e?i.echo(o(n[e])):i.echo(o(n)),i.exit(0)})),e.parse(process.argv);
