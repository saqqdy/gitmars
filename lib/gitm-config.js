#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),i=require("shelljs"),t=require("./js/gitRevParse"),{error:r,success:o,writeFile:s,isGitProject:n}=require("./js/index"),{defaults:c}=require("./js/global");n()||(i.echo(r("当前目录不是git项目目录")),i.exit(1));const a=require("./js/getConfig")();e.name("gitm config").usage("<option> [value]").command("set <option> [value]").description("设置gitmars的配置项").action(((e,n)=>{return l=void 0,u=null,g=function*(){let{filepath:l}=a;if(!l){const{root:e}=t();l=e+"/.gitmarsrc"}n?Object.keys(c).includes(e)?(a[e]=n,delete a.filepath,delete a.skipCI,yield s(l,JSON.stringify(a,null,4)),i.echo(o("保存成功")),i.exit(0)):(i.echo(r("不支持"+e+"这个配置项")),i.exit(1)):(i.echo("请输入要配置的项"),i.exit(1))},new Promise(((e,i)=>{var t=e=>{try{o(g.next(e))}catch(e){i(e)}},r=e=>{try{o(g.throw(e))}catch(e){i(e)}},o=i=>i.done?e(i.value):Promise.resolve(i.value).then(t,r);o((g=g.apply(l,u)).next())}));var l,u,g})),e.name("gitm config").usage("list [option]").command("list [option]").description("查询单个或全部gitmars的配置项").action((e=>{e?i.echo(o(a[e])):i.echo(o(a)),i.exit(0)})),e.parse(process.argv);
