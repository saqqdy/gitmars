#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),a=require("shelljs"),n=require("inquirer"),{options:m,args:o}=require("./conf/go"),{combine:r,end:c,update:t,build:i,start:d,admin:s,branch:u,copy:p,get:l,save:g,revert:h,link:b,unlink:q,postmsg:v}=require("./js/go/index"),{success:f,getCurrent:k}=require("./js/index"),{createArgs:x}=require("./js/tools");e.name("gitm go").usage("[command]").description("智能猜测你要执行的动作"),o.length>0&&e.arguments(x(o)),m.forEach((a=>{e.option(a.flags,a.description,a.defaultValue)})),e.action((async()=>{const e=k();a.echo(f(`当前分支${e}，系统猜测你可能想做以下操作：`)),n.prompt({type:"list",name:"command",message:"请选择你想要的操作?",default:"combine",choices:[new n.Separator(" === 1. Gitmars工作流 === "),"combine","end","update","build","start","admin.publish","admin.update","admin.create","admin.clean",new n.Separator(" === 2. 高级工具 === "),"branch","copy","get","save","revert","link","unlink","postmsg",new n.Separator(" === 退出 === "),"exit",new n.Separator],filter:e=>e}).then((e=>{"exit"===e.command&&(a.echo(f("已退出")),a.exit(0)),a.echo(f(`你选择了${e.command}指令`)),"combine"===e.command?r():"end"===e.command?(a.echo("注意end指令会在执行合并代码到dev和预发之后删除分支"),c()):"update"===e.command?t():"build"===e.command?i():"start"===e.command?d():"admin.publish"===e.command?s.publish():"admin.update"===e.command?s.update():"admin.create"===e.command?s.create():"admin.clean"===e.command?s.clean():"branch"===e.command?u():"copy"===e.command?p():"get"===e.command?l():"save"===e.command?g():"revert"===e.command?h():"link"===e.command?b():"unlink"===e.command?q():"postmsg"===e.command&&v()}))})),e.parse(process.argv);
