#!/usr/bin/env node
"use strict";const{program:e}=require("commander"),o=require("shelljs"),{options:s,args:n}=require("./conf/link"),{createArgs:r}=require("./js/tools");e.name("gitm link").usage("[name]").description("链接本地包"),n.length>0&&e.arguments(r(n)),s.forEach((o=>{e.option(o.flags,o.description,o.defaultValue)})),e.action((e=>{const s=o.test("-L",`./node_modules/${e}`),n=o.test("-e",`./node_modules/${e}`),r=o.which("yarn")?"yarn":"npm";if(e)s?o.rm("-rf",`./node_modules/${e}`):n&&o.mv(`./node_modules/${e}`,`./node_modules/${e}_bak`);else{const{code:e}=o.exec(`${r} link`,{silent:!0});0===e?o.echo("处理完成"):o.echo("出错了"),o.exit(0)}const{code:t}=o.exec(`${r} link ${e}`,{silent:!0});0===t?o.echo("处理完成"):o.echo(`处理失败，${e}软链不存在，请进入本地${e}根目录执行：gitm link`)})),e.parse(process.argv);
