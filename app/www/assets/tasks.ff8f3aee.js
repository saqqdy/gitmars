import{_ as C}from"./index.70ea91fd.js";import{_ as b,o as S,u as D,a as F,T as B,S as T}from"./index.ab0c3978.js";import{u as x}from"./use-current-instance.732c790d.js";import{d as E,r as N,f as V,o as z,y as p,x as a,e as v,v as y,F as P,a4 as R,z as l,D as g,c as A,i as j,C as r,I as K,J as L,a as X,b as n,B as q}from"./vendor/element-plus_2.1.8.js.544d1606.js";import"./vendor/axios-ex_2.2.4.js.09bd27c1.js";import"./vendor/axios_0.24.0.js.52256a15.js";import"./vendor/xterm_4.18.0.js.499cd352.js";import"./vendor/qs_6.10.3.js.e370f461.js";import"./vendor/uuid_8.3.2.js.8656f24a.js";import"./vendor/dayjs_1.11.0.js.441fd857.js";import"./vendor/lodash-es_4.17.21.js.5db20fff.js";const H=E({name:"ControlTasks",components:{Xterm:C},async setup(){const{getTerminal:t}=j(B,{}),{socket:m}=j(T,{}),{globalProperties:{$axios:c}}=x(),_=D(),d=F(),h=window.innerWidth,i=window.innerHeight,e=N({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1}),u=V(()=>"tasks-"+e.project.id);z(()=>{}),S(()=>{});const s=async()=>(await c({url:"/common/project/list",data:{id:d.query.id}})).data,f=async()=>{const{data:{scripts:o}}=await c({url:"/cmd/fs/read",data:{path:`${e.project.path}/package.json`}});return o},I=()=>{_.push("/project/list")},k=o=>{!e.terminal||m.emit(e.terminal.name+"-input",` ${o}\r`)},$=o=>{k(`yarn run ${o}`)};return e.project=await s(),e.scripts=await f(),await c({url:"/cmd/cd",data:{dir:e.project.path}}),e.terminal=t&&t(u.value,e.project.path,parseInt(String((h-60-300-32)/7.05)),parseInt(String((i-64-32-34)/(16*1.1)))),e.ready=!0,{data:e,terminalID:u,back:I,exec:k,run:$,route:d}}}),w=t=>(K("data-v-2d6f5dfa"),t=t(),L(),t),J={key:0,class:"page"},M=r(" tasks "),O=r(" \u8FD4\u56DE "),W={class:"cont"},G={class:"nav"},Q={key:0,class:"bugfix"},U=w(()=>a("dt",null,"\u811A\u672C\u6307\u4EE4",-1)),Y=r(" \u6267\u884C "),Z={class:"main"},tt=w(()=>a("span",null,[a("span",{class:"iconfont icon-layout"}),r(" \u5F53\u524D\u5206\u652F\uFF1A ")],-1));function et(t,m,c,_,d,h){const i=X("v3-button"),e=C;return t.data.ready?(n(),p("div",J,[a("h1",null,[M,a("p",null,[v(i,{type:"default",onClick:t.back},{default:y(()=>[O]),_:1},8,["onClick"])])]),a("div",W,[a("div",G,[Object.keys(t.data.scripts).length>0?(n(),p("dl",Q,[U,(n(!0),p(P,null,R(t.data.scripts,(u,s)=>(n(),p("dd",{class:q({active:!1}),key:s},[r(g(s)+" ",1),v(i,{type:"primary",size:"mini",onClick:f=>t.run(s),plain:""},{default:y(()=>[Y]),_:2},1032,["onClick"])]))),128))])):l("",!0)]),a("div",Z,[a("h3",null,[tt,a("p",null,g(t.data.project.path),1)]),t.data.project?(n(),A(e,{ref:"xterm",class:"xterm",key:"tasks-xterm",id:t.terminalID,path:t.data.project.path},null,8,["id","path"])):l("",!0)])])])):l("",!0)}var mt=b(H,[["render",et],["__scopeId","data-v-2d6f5dfa"]]);export{mt as default};
