import{I as a,a8 as t,a9 as s,r as e,B as r,ah as n,g as c,o as i,j as d,i as o,e as p,w as l,F as m,ab as u,k as j,t as y,h as f,q as h,v as k,x as v,p as b}from"./vendor.dc4bbc83.js";import{X as x}from"./index.0ca2f30d.js";import{_ as g,T as w,S as _}from"./index.ed23a553.js";import{u as $}from"./use-current-instance.ff4ed52e.js";const C={name:"ControlTasks",components:{Xterm:x},async setup(){const{getTerminal:c}=a(w,{}),{socket:i}=a(_,{}),{globalProperties:{$axios:d}}=$();t();const o=s(),p=e({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1});r((()=>{})),n((()=>{}));const l=a=>{p.terminal&&i.emit(p.terminal.name+"-input",` ${a}\r`)};return p.project=await(async()=>(await d({url:"/common/project/list",data:{id:o.query.id}})).data)(),p.scripts=await(async()=>{const{data:{scripts:a}}=await d({url:"/cmd/fs/read",data:{path:`${p.project.path}/package.json`}});return a})(),await d({url:"/cmd/cd",data:{dir:p.project.path}}),p.terminal=c&&c(p.project.id,p.project.path),p.ready=!0,{data:p,exec:l,run:a=>{l(`yarn run ${a}`)},route:o}}},T=a=>(k("data-v-751be222"),a=a(),v(),a),X={key:0,class:"page"},q=h(" tasks "),I=h("创建分支"),z={class:"cont"},B={class:"nav"},F={key:0,class:"bugfix"},O=T((()=>o("dt",null,"脚本指令",-1))),P=h("执行"),S={class:"main"},A=T((()=>o("span",null,[o("span",{class:"iconfont icon-layout"}),h(" 当前分支： ")],-1)));var D=g(C,[["render",function(a,t,s,e,r,n){const k=c("v3-button"),v=c("Xterm");return e.data.ready?(i(),d("div",X,[o("h1",null,[q,o("p",null,[p(k,{type:"primary"},{default:l((()=>[I])),_:1})])]),o("div",z,[o("div",B,[Object.keys(e.data.scripts).length>0?(i(),d("dl",F,[O,(i(!0),d(m,null,u(e.data.scripts,((a,t)=>(i(),d("dd",{class:b({active:!1}),key:t},[h(y(t)+" ",1),p(k,{type:"primary",size:"mini",onClick:a=>e.run(t),plain:""},{default:l((()=>[P])),_:2},1032,["onClick"])])))),128))])):j("",!0)]),o("div",S,[o("h3",null,[A,o("p",null,y(e.data.project.path),1)]),e.data.project?(i(),f(v,{key:0,ref:"xterm",class:"xterm",id:e.data.project.id,path:e.data.project.path},null,8,["id","path"])):j("",!0)])])])):j("",!0)}],["__scopeId","data-v-751be222"]]);export{D as default};
