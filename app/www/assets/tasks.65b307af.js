import{H as a,a7 as t,a8 as s,r as e,A as r,ag as n,f as c,o as i,i as o,h as d,d as p,w as l,F as m,aa as u,j as f,t as j,g as y,p as h,s as v,v as k,m as b}from"./vendor.2fe58688.js";import{X as g}from"./index.420b5256.js";import{_ as x,T as w,S as _}from"./index.df4ab96c.js";import{u as $}from"./use-current-instance.72856c47.js";const C={name:"ControlTasks",components:{Xterm:g},async setup(){const{getTerminal:c}=a(w,{}),{socket:i}=a(_,{}),{globalProperties:{$axios:o}}=$();t();const d=s(),p=e({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1});r((()=>{})),n((()=>{}));const l=a=>{p.terminal&&i.emit(p.terminal.name+"-input",` ${a}\r`)};return p.project=await(async()=>(await o({url:"/common/project/list",data:{id:d.query.id}})).data)(),p.scripts=await(async()=>{const{data:{scripts:a}}=await o({url:"/cmd/fs/read",data:{path:`${p.project.path}/package.json`}});return a})(),await o({url:"/cmd/cd",data:{dir:p.project.path}}),p.terminal=c&&c(p.project.id,p.project.path),p.ready=!0,{data:p,exec:l,run:a=>{l(`yarn run ${a}`)},route:d}}},T=a=>(v("data-v-9acffeb6"),a=a(),k(),a),X={key:0,class:"page"},q=h(" tasks "),z=h("创建分支"),A={class:"cont"},F={class:"nav"},H={key:0,class:"bugfix"},I=T((()=>d("dt",null,"脚本指令",-1))),O=h("执行"),P={class:"main"},S=T((()=>d("span",null,[d("span",{class:"iconfont icon-layout"}),h(" 当前分支： ")],-1)));var B=x(C,[["render",function(a,t,s,e,r,n){const v=c("v3-button"),k=c("Xterm");return e.data.ready?(i(),o("div",X,[d("h1",null,[q,d("p",null,[p(v,{type:"primary"},{default:l((()=>[z])),_:1})])]),d("div",A,[d("div",F,[Object.keys(e.data.scripts).length>0?(i(),o("dl",H,[I,(i(!0),o(m,null,u(e.data.scripts,((a,t)=>(i(),o("dd",{class:b({active:!1}),key:t},[h(j(t)+" ",1),p(v,{type:"primary",size:"mini",onClick:a=>e.run(t),plain:""},{default:l((()=>[O])),_:2},1032,["onClick"])])))),128))])):f("",!0)]),d("div",P,[d("h3",null,[S,d("p",null,j(e.data.project.path),1)]),e.data.project?(i(),y(k,{key:0,ref:"xterm",class:"xterm",id:e.data.project.id,path:e.data.project.path},null,8,["id","path"])):f("",!0)])])])):f("",!0)}],["__scopeId","data-v-9acffeb6"]]);export{B as default};
