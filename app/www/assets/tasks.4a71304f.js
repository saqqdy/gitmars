import{M as a,ae as t,af as s,r as e,I as r,an as n,j as i,o as c,p as o,m as d,e as p,w as l,F as m,ah as u,q as j,x as y,k as f,v as h,z as k,A as v,t as b}from"./vendor.80552b3f.js";import{X as x}from"./index.ea7d3781.js";import{_ as g,T as w,S as _}from"./index.b25b7560.js";import{u as $}from"./use-current-instance.78f6f767.js";const C={name:"ControlTasks",components:{Xterm:x},async setup(){const{getTerminal:i}=a(w,{}),{socket:c}=a(_,{}),{globalProperties:{$axios:o}}=$();t();const d=s(),p=e({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1});r((()=>{})),n((()=>{}));const l=a=>{p.terminal&&c.emit(p.terminal.name+"-input",` ${a}\r`)};return p.project=await(async()=>(await o({url:"/common/project/list",data:{id:d.query.id}})).data)(),p.scripts=await(async()=>{const{data:{scripts:a}}=await o({url:"/cmd/fs/read",data:{path:`${p.project.path}/package.json`}});return a})(),await o({url:"/cmd/cd",data:{dir:p.project.path}}),p.terminal=i&&i(p.project.id,p.project.path),p.ready=!0,{data:p,exec:l,run:a=>{l(`yarn run ${a}`)},route:d}}},T=a=>(k("data-v-751be222"),a=a(),v(),a),X={key:0,class:"page"},q=h(" tasks "),z=h("创建分支"),I={class:"cont"},A={class:"nav"},F={key:0,class:"bugfix"},M=T((()=>d("dt",null,"脚本指令",-1))),O=h("执行"),P={class:"main"},S=T((()=>d("span",null,[d("span",{class:"iconfont icon-layout"}),h(" 当前分支： ")],-1)));var B=g(C,[["render",function(a,t,s,e,r,n){const k=i("v3-button"),v=i("Xterm");return e.data.ready?(c(),o("div",X,[d("h1",null,[q,d("p",null,[p(k,{type:"primary"},{default:l((()=>[z])),_:1})])]),d("div",I,[d("div",A,[Object.keys(e.data.scripts).length>0?(c(),o("dl",F,[M,(c(!0),o(m,null,u(e.data.scripts,((a,t)=>(c(),o("dd",{class:b({active:!1}),key:t},[h(y(t)+" ",1),p(k,{type:"primary",size:"mini",onClick:a=>e.run(t),plain:""},{default:l((()=>[O])),_:2},1032,["onClick"])])))),128))])):j("",!0)]),d("div",P,[d("h3",null,[S,d("p",null,y(e.data.project.path),1)]),e.data.project?(c(),f(v,{key:0,ref:"xterm",class:"xterm",id:e.data.project.id,path:e.data.project.path},null,8,["id","path"])):j("",!0)])])])):j("",!0)}],["__scopeId","data-v-751be222"]]);export{B as default};
