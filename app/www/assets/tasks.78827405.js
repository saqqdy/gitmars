import{N as a,ah as t,ai as s,r as e,c as r,K as n,aq as i,j as c,q as o,p as l,e as d,m as p,F as m,ak as u,s as k,y as j,k as y,x as h,B as f,C as v,o as x,v as g}from"./vendor.7056a65f.js";import{X as w}from"./index.4649ac61.js";import{_ as b,T as C,S as I}from"./index.53615b74.js";import{u as _}from"./use-current-instance.d04f1ee4.js";const $={name:"ControlTasks",components:{Xterm:w},async setup(){const{getTerminal:c}=a(C,{}),{socket:o}=a(I,{}),{globalProperties:{$axios:l}}=_(),d=t(),p=s(),m=window.innerWidth,u=window.innerHeight,k=e({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1}),j=r((()=>"tasks-"+k.project.id));n((()=>{})),i((()=>{}));const y=a=>{k.terminal&&o.emit(k.terminal.name+"-input",` ${a}\r`)};return k.project=await(async()=>(await l({url:"/common/project/list",data:{id:p.query.id}})).data)(),k.scripts=await(async()=>{const{data:{scripts:a}}=await l({url:"/cmd/fs/read",data:{path:`${k.project.path}/package.json`}});return a})(),await l({url:"/cmd/cd",data:{dir:k.project.path}}),k.terminal=c&&c(j.value,k.project.path,parseInt(String((m-60-300-32)/7.05)),parseInt(String((u-64-32-34)/17.6))),k.ready=!0,{data:k,terminalID:j,back:()=>{d.push("/project/list")},exec:y,run:a=>{y(`yarn run ${a}`)},route:p}}},q=a=>(f("data-v-46505152"),a=a(),v(),a),S={key:0,class:"page"},T=h(" tasks "),X=h("返回"),D={class:"cont"},z={class:"nav"},B={key:0,class:"bugfix"},F=q((()=>l("dt",null,"脚本指令",-1))),H=h("执行"),K={class:"main"},N=q((()=>l("span",null,[l("span",{class:"iconfont icon-layout"}),h(" 当前分支： ")],-1)));var O=b($,[["render",function(a,t,s,e,r,n){const i=c("v3-button"),f=c("Xterm");return e.data.ready?(x(),o("div",S,[l("h1",null,[T,l("p",null,[d(i,{type:"default",onClick:e.back},{default:p((()=>[X])),_:1},8,["onClick"])])]),l("div",D,[l("div",z,[Object.keys(e.data.scripts).length>0?(x(),o("dl",B,[F,(x(!0),o(m,null,u(e.data.scripts,((a,t)=>(x(),o("dd",{class:g({active:!1}),key:t},[h(j(t)+" ",1),d(i,{type:"primary",size:"mini",onClick:a=>e.run(t),plain:""},{default:p((()=>[H])),_:2},1032,["onClick"])])))),128))])):k("",!0)]),l("div",K,[l("h3",null,[N,l("p",null,j(e.data.project.path),1)]),e.data.project?(x(),y(f,{ref:"xterm",class:"xterm",key:"tasks-xterm",id:e.terminalID,path:e.data.project.path},null,8,["id","path"])):k("",!0)])])])):k("",!0)}],["__scopeId","data-v-46505152"]]);export{O as default};
