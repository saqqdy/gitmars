import{u as a,b as s,o as t}from"./vendor/vue-router_4.0.12.js.e0928a4d.js";import{X as e}from"./index.63e1ebaa.js";import{_ as r,T as o,S as n}from"./index.39c9dbc1.js";import{u as i}from"./use-current-instance.44876874.js";import{j as d,_ as c,c as p,d as j,R as l,y as m,B as u,U as v,O as b,F as _,a1 as f,z as y,H as h,M as k,a3 as x,ag as g,ah as w,x as C,E as I}from"./vendor/vue_3.2.20.js.843b181b.js";import"./vendor/element-plus_1.1.0-beta.24.js.9ec41c30.js";import"./vendor/lodash_4.17.21.js.96bc0cd8.js";import"./vendor/xterm_4.14.1.js.4d8f2388.js";import"./vendor/dayjs_1.10.7.js.de411334.js";import"./vendor/async-validator_4.0.7.js.656181ea.js";import"./vendor/resize-observer-polyfill_1.5.1.js.3b3964c6.js";import"./vendor/axios_0.23.0.js.3f49b9ab.js";import"./vendor/qs_6.10.1.js.6d009611.js";import"./vendor/side-channel_1.0.4.js.cbb25fc8.js";import"./vendor/get-intrinsic_1.1.1.js.d604dad5.js";import"./vendor/has-symbols_1.0.2.js.208f1d3f.js";import"./vendor/function-bind_1.1.1.js.34bf890b.js";import"./vendor/has_1.0.3.js.e7f09f2c.js";import"./vendor/call-bind_1.0.2.js.ad02ab55.js";import"./vendor/object-inspect_1.11.0.js.1111bad4.js";import"./vendor/js-cool_2.2.4.js.e0ea198b.js";import"./vendor/core-js_3.19.0.js.95aab93d.js";import"./vendor/uuid_8.3.2.js.8656f24a.js";import"./vendor/xterm-style_1.1.0.js.323fb105.js";import"./vendor/xterm-addon-fit_0.5.0.js.e3a24a28.js";import"./vendor/xterm-addon-search_0.8.1.js.d370edfa.js";import"./vendor/xterm-addon-web-links_0.4.0.js.e4a83512.js";import"./vendor/vuex_4.0.2.js.f8c5ab46.js";const $={name:"ControlTasks",components:{Xterm:e},async setup(){const{getTerminal:e}=d(o,{}),{socket:r}=d(n,{}),{globalProperties:{$axios:l}}=i(),m=a(),u=s(),v=window.innerWidth,b=window.innerHeight,_=c({project:{id:"",name:"",path:""},scripts:[],terminal:{name:""},ready:!1}),f=p((()=>"tasks-"+_.project.id));j((()=>{})),t((()=>{}));const y=a=>{_.terminal&&r.emit(_.terminal.name+"-input",` ${a}\r`)};return _.project=await(async()=>(await l({url:"/common/project/list",data:{id:u.query.id}})).data)(),_.scripts=await(async()=>{const{data:{scripts:a}}=await l({url:"/cmd/fs/read",data:{path:`${_.project.path}/package.json`}});return a})(),await l({url:"/cmd/cd",data:{dir:_.project.path}}),_.terminal=e&&e(f.value,_.project.path,parseInt(String((v-60-300-32)/7.05)),parseInt(String((b-64-32-34)/17.6))),_.ready=!0,{data:_,terminalID:f,back:()=>{m.push("/project/list")},exec:y,run:a=>{y(`yarn run ${a}`)},route:u}}},z=a=>(g("data-v-46505152"),a=a(),w(),a),S={key:0,class:"page"},T=x(" tasks "),X=x("返回"),q={class:"cont"},D={class:"nav"},H={key:0,class:"bugfix"},O=z((()=>u("dt",null,"脚本指令",-1))),B=x("执行"),E={class:"main"},F=z((()=>u("span",null,[u("span",{class:"iconfont icon-layout"}),x(" 当前分支： ")],-1)));var M=r($,[["render",function(a,s,t,e,r,o){const n=l("v3-button"),i=l("Xterm");return e.data.ready?(C(),m("div",S,[u("h1",null,[T,u("p",null,[v(n,{type:"default",onClick:e.back},{default:b((()=>[X])),_:1},8,["onClick"])])]),u("div",q,[u("div",D,[Object.keys(e.data.scripts).length>0?(C(),m("dl",H,[O,(C(!0),m(_,null,f(e.data.scripts,((a,s)=>(C(),m("dd",{class:I({active:!1}),key:s},[x(h(s)+" ",1),v(n,{type:"primary",size:"mini",onClick:a=>e.run(s),plain:""},{default:b((()=>[B])),_:2},1032,["onClick"])])))),128))])):y("",!0)]),u("div",E,[u("h3",null,[F,u("p",null,h(e.data.project.path),1)]),e.data.project?(C(),k(i,{ref:"xterm",class:"xterm",key:"tasks-xterm",id:e.terminalID,path:e.data.project.path},null,8,["id","path"])):y("",!0)])])])):y("",!0)}],["__scopeId","data-v-46505152"]]);export{M as default};
